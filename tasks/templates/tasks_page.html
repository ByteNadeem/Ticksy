{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasks - Ticksy ToDo</title>
    <link rel="stylesheet" href="{% static 'style.css' %}?v=5.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
         <nav class="top-nav">
    <a href="{% url 'home' %}" class="header-logo">
            <img src="{% static 'images/tricksy-logo-sm.png' %}" alt="Ticksy logo" />
            <div class="logo-text lobster-regular">Ticksy</div>
    </a>
    <input id="menu-toggle" type="checkbox" />
    <label class='menu-button-container' for="menu-toggle">
    <div class='menu-button'></div>
  </label>
    <ul class="menu">
      <li><a href="{% url 'home' %}">Home</a></li>
      <li><a href="/admin/">Admin</a></li>
      <li><a href="{% url 'tasks' %}">Tasks</a></li>
    </ul>
</nav>
    </header>

    <main>
        <section class="bg-colour2" id="tasks">
            <div class="standard-section">
                <div class="tasks-section">
                    <h2 class="lobster-regular">Your Tasks</h2>
                    
                    <!-- Add New Task Form -->
                    <div class="add-task-form">
                        <h3>Add a new task</h3>
                        <form method="post" action="{% url 'tasks' %}">
                            {% csrf_token %}
                            <div class="form-row">
                                {{ form.title|as_crispy_field }}
                                {{ form.due_date|as_crispy_field }}
                                {{ form.category|as_crispy_field }}
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-plus"></i> Add Task
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- To Do Tasks -->
                    <div class="tasks-container">
                        <div class="todo-section">
                            <h3>To Do</h3>
                            {% if to_do_tasks %}
                                <div class="tasks-grid">
                                    {% for task in to_do_tasks %}
                                    <div class="task-card">
                                        <div class="task-header">
                                            <h4>{{ task.title }}</h4>
                                            <span class="task-category">{{ task.category.name }}</span>
                                        </div>
                                        <div class="task-details">
                                            {% if task.due_date %}
                                                <p class="due-date">Due: {{ task.due_date|date:"M d, Y" }}</p>
                                            {% endif %}
                                            <div class="task-status">
                                                <span class="status pending">○ Pending</span>
                                            </div>
                                        </div>
                                        <div class="task-actions">
                                            <a href="{% url 'task_detail' task.id %}" class="btn-small">
                                                <i class="fas fa-eye"></i> View
                                            </a>
                                            <a href="{% url 'task_edit' task.id %}" class="btn-small">
                                                <i class="fas fa-edit"></i> Edit
                                            </a>
                                            <a href="{% url 'task_toggle_complete' task.id %}" class="btn-small">
                                                <i class="fas fa-check"></i> Complete
                                            </a>
                                            <a href="{% url 'task_delete' task.id %}" class="btn-small btn-danger">
                                                <i class="fas fa-trash"></i> Delete
                                            </a>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="no-tasks">
                                    <p>No pending tasks! Great job!</p>
                                </div>
                            {% endif %}
                        </div>
                        
                        <!-- Done Tasks -->
                        <div class="done-section">
                            <h3>Done</h3>
                            {% if done_tasks %}
                                <div class="tasks-grid">
                                    {% for task in done_tasks %}
                                    <div class="task-card completed">
                                        <div class="task-header">
                                            <h4>{{ task.title }}</h4>
                                            <span class="task-category">{{ task.category.name }}</span>
                                        </div>
                                        <div class="task-details">
                                            {% if task.due_date %}
                                                <p class="due-date">Due: {{ task.due_date|date:"M d, Y" }}</p>
                                            {% endif %}
                                            <div class="task-status">
                                                <span class="status completed">✓ Completed</span>
                                            </div>
                                        </div>
                                        <div class="task-actions">
                                            <a href="{% url 'task_detail' task.id %}" class="btn-small">
                                                <i class="fas fa-eye"></i> View
                                            </a>
                                            <a href="{% url 'task_edit' task.id %}" class="btn-small">
                                                <i class="fas fa-edit"></i> Edit
                                            </a>
                                            <a href="{% url 'task_toggle_complete' task.id %}" class="btn-small">
                                                <i class="fas fa-undo"></i> Mark Pending
                                            </a>
                                            <a href="{% url 'task_delete' task.id %}" class="btn-small btn-danger">
                                                <i class="fas fa-trash"></i> Delete
                                            </a>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="no-tasks">
                                    <p>No completed tasks yet.</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer>

    </footer>

</body>
</html>
