{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasks - Ticksy ToDo</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Task card styling with background colors */
        .task-card {
            background: #f8f9ff !important; /* Light blue for pending tasks */
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #f46b45;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
        }

        .task-card.completed {
            background: #f0f8f0 !important; /* Light green for completed tasks */
            border-left-color: #4CAF50;
        }

        /* Status badge colors */
        .status.pending {
            background: #ff9800 !important; /* Orange background for pending */
            color: white !important;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status.completed {
            background: #4CAF50 !important; /* Green background for completed */
            color: white !important;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        /* CRUD buttons styling */
        .task-actions {
            margin-top: 25px !important;
            padding-top: 20px !important;
            border-top: 2px solid #e0e0e0 !important;
            display: flex !important;
            gap: 10px !important;
            flex-wrap: wrap;
        }

        .btn-small {
            display: inline-flex !important;
            align-items: center !important;
            padding: 8px 14px !important;
            color: white !important;
            text-decoration: none !important;
            border-radius: 6px !important;
            font-size: 11px !important;
            font-weight: 600 !important;
            transition: all 0.3s ease !important;
            border: none !important;
            cursor: pointer !important;
            min-height: 32px !important;
        }

        /* View button - Blue */
        a.btn-small[href*="task_detail"] {
            background: #007bff !important; /* Bright blue */
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.2) !important;
        }

        a.btn-small[href*="task_detail"]:hover {
            background: #0056b3 !important;
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3) !important;
        }

        /* Edit button - Orange */
        a.btn-small[href*="task_edit"] {
            background: #fd7e14 !important; /* Bright orange */
            box-shadow: 0 2px 4px rgba(253, 126, 20, 0.2) !important;
        }

        a.btn-small[href*="task_edit"]:hover {
            background: #e8650d !important;
            box-shadow: 0 4px 8px rgba(253, 126, 20, 0.3) !important;
        }

        /* Complete/Mark Pending button - Green */
        a.btn-small[href*="task_toggle_complete"] {
            background: #28a745 !important; /* Bright green */
            box-shadow: 0 2px 4px rgba(40, 167, 69, 0.2) !important;
        }

        a.btn-small[href*="task_toggle_complete"]:hover {
            background: #1e7e34 !important;
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3) !important;
        }

        .btn-small.btn-danger {
            background: #dc3545 !important; /* Red background for delete */
            box-shadow: 0 2px 4px rgba(220, 53, 69, 0.2) !important;
        }

        .btn-small:hover {
            transform: translateY(-1px) !important;
            color: white !important;
            text-decoration: none !important;
        }

        .btn-small.btn-danger:hover {
            background: #c82333 !important; /* Darker red on hover */
            box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3) !important;
        }

        /* Icon spacing */
        .btn-small i {
            margin-right: 6px !important;
            font-size: 11px !important;
        }

        /* Message alerts styling */
        .alert-success {
            background: #d4edda !important;
            color: #155724 !important;
            border: 1px solid #c3e6cb !important;
        }
        
        .alert-error, .alert-danger {
            background: #f8d7da !important;
            color: #721c24 !important;
            border: 1px solid #f5c6cb !important;
        }
        
        .alert-warning {
            background: #fff3cd !important;
            color: #856404 !important;
            border: 1px solid #ffeaa7 !important;
        }
        
        .alert-info {
            background: #d1ecf1 !important;
            color: #0c5460 !important;
            border: 1px solid #bee5eb !important;
        }
    </style>
</head>
<body>
    <header>
         <nav class="top-nav">
    <a href="{% url 'home' %}" class="header-logo">
            <img src="{% static 'images/tricksy-logo-sm.png' %}" alt="Ticksy logo">
            <div class="logo-text lobster-regular">Ticksy</div>
    </a>
    {% if user.is_authenticated %}
        <div style="display: flex; align-items: center; margin-left: 15px; color: #333; font-weight: 600; position: absolute; left: 180px;">
            <i class="fas fa-user" style="color: #f46b45; margin-right: 8px;"></i> {{ user.username }}
        </div>
    {% endif %}
    <input id="menu-toggle" type="checkbox">
<label class="menu-button-container" for="menu-toggle">
  <span class="menu-button"></span>
</label>
    <ul class="menu">
        <li><a href="{% url 'home' %}">Home</a></li>
        {% if user.is_authenticated %}
            <li><a href="{% url 'tasks' %}">My Tasks</a></li>
            {% if is_admin %}
                <li><a href="/admin/">Admin</a></li>
            {% endif %}
            <li>
                <a href="{% url 'account_logout' %}" style="background: #dc3545; color: white; padding: 8px 16px; border-radius: 5px; text-decoration: none;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </li>
        {% else %}
            <li><a href="{% url 'account_signup' %}">
                <i class="fas fa-user-plus"></i> Register
            </a></li>
            <li><a href="{% url 'account_login' %}">
                <i class="fas fa-sign-in-alt"></i> Login
            </a></li>
        {% endif %}
    </ul>
</nav>
    </header>

    <main>
        <!-- Django Messages Display -->
        {% if messages %}
            <div class="messages-container" style="margin: 20px auto; max-width: 1200px; padding: 0 20px;">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" 
                         style="padding: 12px 16px; margin-bottom: 10px; border-radius: 8px; border: none; font-weight: 500; position: relative;">
                        {% if message.tags == 'error' %}
                            <i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i>
                        {% elif message.tags == 'warning' %}
                            <i class="fas fa-exclamation-circle" style="margin-right: 8px;"></i>
                        {% elif message.tags == 'success' %}
                            <i class="fas fa-check-circle" style="margin-right: 8px;"></i>
                        {% else %}
                            <i class="fas fa-info-circle" style="margin-right: 8px;"></i>
                        {% endif %}
                        {{ message }}
                        <span onclick="this.parentElement.style.display='none'" 
                              style="position: absolute; right: 10px; top: 8px; cursor: pointer; font-size: 18px; color: inherit; opacity: 0.7;">×</span>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        
        <section class="bg-colour2" id="tasks">
            <div class="standard-section">
                <div class="tasks-section">
                    <h2 class="lobster-regular">Your Tasks</h2>
                    
                    <!-- Add New Task Form -->
                    <div class="add-task-form">
                        <h3>Add a new task</h3>
                        <form method="post" action="{% url 'tasks' %}">
                            {% csrf_token %}
                            <div class="form-row">
                                {{ form.title|as_crispy_field }}
                                {{ form.due_date|as_crispy_field }}
                                {{ form.category|as_crispy_field }}
                                <button type="submit" class="btn-primary">
                                    <i class="fas fa-plus"></i> Add Task
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- To Do Tasks -->
                    <div class="tasks-container">
                        <div class="todo-section">
                            <h3>To Do</h3>
                            {% if to_do_tasks %}
                                <div class="tasks-grid">
                                    {% for task in to_do_tasks %}
                                    <div class="task-card">
                                        <div class="task-header">
                                            <h4>{{ task.title }}</h4>
                                            <span class="task-category">{{ task.category.name }}</span>
                                        </div>
                                        <div class="task-details">
                                            {% if task.due_date %}
                                                <p class="due-date">Due: {{ task.due_date|date:"M d, Y" }}</p>
                                            {% endif %}
                                            <div class="task-status">
                                                <span class="status pending">○ Pending</span>
                                            </div>
                                        </div>
                                        <div class="task-actions">
                                            <a href="{% url 'task_detail' task.id %}" class="btn-small">
                                                <i class="fas fa-eye"></i> View
                                            </a>
                                            <a href="{% url 'task_edit' task.id %}" class="btn-small">
                                                <i class="fas fa-edit"></i> Edit
                                            </a>
                                            <a href="{% url 'task_toggle_complete' task.id %}" class="btn-small">
                                                <i class="fas fa-check"></i> Complete
                                            </a>
                                            <a href="{% url 'task_delete' task.id %}" class="btn-small btn-danger">
                                                <i class="fas fa-trash"></i> Delete
                                            </a>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="no-tasks">
                                    <p>No pending tasks! Great job!</p>
                                </div>
                            {% endif %}
                        </div>
                        
                        <!-- Done Tasks -->
                        <div class="done-section">
                            <h3>Done</h3>
                            {% if done_tasks %}
                                <div class="tasks-grid">
                                    {% for task in done_tasks %}
                                    <div class="task-card completed">
                                        <div class="task-header">
                                            <h4>{{ task.title }}</h4>
                                            <span class="task-category">{{ task.category.name }}</span>
                                        </div>
                                        <div class="task-details">
                                            {% if task.due_date %}
                                                <p class="due-date">Due: {{ task.due_date|date:"M d, Y" }}</p>
                                            {% endif %}
                                            <div class="task-status">
                                                <span class="status completed">✓ Completed</span>
                                            </div>
                                        </div>
                                        <div class="task-actions">
                                            <a href="{% url 'task_detail' task.id %}" class="btn-small">
                                                <i class="fas fa-eye"></i> View
                                            </a>
                                            <a href="{% url 'task_edit' task.id %}" class="btn-small">
                                                <i class="fas fa-edit"></i> Edit
                                            </a>
                                            <a href="{% url 'task_toggle_complete' task.id %}" class="btn-small">
                                                <i class="fas fa-undo"></i> Mark Pending
                                            </a>
                                            <a href="{% url 'task_delete' task.id %}" class="btn-small btn-danger">
                                                <i class="fas fa-trash"></i> Delete
                                            </a>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="no-tasks">
                                    <p>No completed tasks yet.</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="site-footer">
  <div class="footer-container">
    <div class="social-icons">
      <a href="https://www.instagram.com" target="_blank" aria-label="Instagram">
        <i class="fab fa-instagram"></i>
      </a>
      <a href="https://www.facebook.com" target="_blank" aria-label="Facebook">
        <i class="fab fa-facebook-f"></i>
      </a>
      <a href="https://www.linkedin.com" target="_blank" aria-label="LinkedIn">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </div>
    <div class="footer-text">
      <p>&copy; 2025 Ticksy. All rights reserved.</p>
    </div>
  </div>
</footer>

</body>
</html>
